
# Forklift Desirer - 高仿真集装箱装载优化系统

Forklift Desirer 不仅仅是一个理论上的空间堆叠工具，它是一个深度集成物流实操规范（Real-world Logistics Constraints）的智能决策系统。本系统不仅考虑容积最大化，更核心地解决了“如何物理装进去”和“如何安全搬运”的问题。

## 🚀 核心仿真与实操逻辑 (Real-world Feasibility)

为了确保生成的装载方案在码头和仓库具有 100% 的可执行性，我们实施了以下核心限制：

### 1. 物理门洞通过性校验 (Door Dimension Validation)
*   **逻辑**：集装箱的门框通常比内部空间窄（宽/高约少 5-10cm）。
*   **约束**：算法在装载前会强制校验货物尺寸。如果货物的宽/高在任何旋转方向下都无法通过 `doorDimensions`，该货物将被标记为不可装载，防止出现“理论能塞下，门口进不去”的尴尬。

### 2. 叉车装载路径避障 (Access Path Logic)
*   **逻辑**：货物必须能从集装箱后部（门）推送到最深处（前壁）。
*   **约束**：在放置一个新货物时，系统会校验从该位置到箱门之间的“矩形通道”是否已被其他货物占用。
*   **避障**：如果通道被堵塞，算法将拒绝该放置点。这确保了叉车或人工有足够的物理空间完成作业，而不是在 3D 空间中“穿墙”放置。

### 3. 单机作业序列化 (Single Carrier Sequencing)
*   **逻辑**：现实中一个柜子一次只能进一台叉车或一名工人。
*   **约束**：动画系统采用了严格的串行时间线（Sequential Delay）。只有在前一件货物完成放置、载具退出后，下一件货物的装载过程才会开始，提供最真实的作业节奏反馈。

### 4. 预留抬高位置逻辑 (Over-lift / Reserved Height)
*   **逻辑**：叉车在放置货物（尤其是叠放）时，必须先将货叉抬高到超过目标平面的一定高度，平推到位后再下降。
*   **约束**：我们引入了 `LIFT_BUFFER` (10cm) 机制。动画分为：**进入 -> 抬高至安全高度 -> 平推入位 -> 垂直落位**。这避免了货叉在平移过程中与下层货物发生擦碰或穿模。

### 5. 载具自适应偏移 (Side-shift Alignment)
*   **逻辑**：集装箱宽度有限，叉车车体与货物中心不一定总能对齐。
*   **约束**：系统模拟了叉车的“侧移器”功能。当货物靠近侧壁时，叉车底盘会停留在安全中位，仅通过货叉的物理偏移来放置货物，最大程度减少了载具碰撞箱壁的概率。

## 🛠 技术实现细节

*   **坐标系**：Y轴向上，X轴为长度方向（0 为前壁，Max 为箱门）。
*   **旋转策略**：支持 L/W 交换（长宽切换），并实时重新计算路径通过性和门洞通过性。
*   **支撑校验**：任何非地面货物必须获得下方货物至少 70% 的面积支撑，且下方货物必须未标记为 `unstackable`。
*   **安全余量**：所有集装箱内部尺寸均减去了 `OPERATION_BUFFER` (2cm) 的运行公差，以应对现实中纸箱胀包或集装箱轻微变形的情况。

## 📦 使用建议

1.  **添加货物**：在 Manifest 中输入货物的长宽高及重量。
2.  **设置属性**：对于精密仪器或易损件，务必勾选 `Unstackable`。
3.  **观察动画**：通过 3D 视图确认叉车的作业轨迹，确保装载顺序符合重货在下、轻货在上的原则。
4.  **AI 协助**：通过右侧聊天框上传装箱单照片，AI 会自动识别尺寸并同步到 manifest。