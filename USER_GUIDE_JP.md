# Forklift Desirer (フォークリフト・デザイアー) ユーザーガイド

Forklift Desirer は、実世界の物理制約（フォークリフトの動き、積み付けルールなど）を考慮した、高精度なコンテナ積み付けシミュレーションソフトです。

本ガイドでは、基本的な使い方を説明します。

---

## 1. インストール・起動方法

1.  配布されたフォルダ内の **`Forklift Desirer.exe`** をダブルクリックして起動します。
    *   インストールは不要です（ポータブル版の場合）。

---

## 2. 貨物データの入力 (Cargo Input)

画面左側のパネルで貨物を登録します。以下の方法があります。

### 方法 A: 手動入力 (Manual)
1.  **Name**: 貨物名を入力。
2.  **Length / Width / Height**: サイズを **cm（センチメートル）** 単位で入力します。
3.  **Weight**: 重量を **kg** で入力します。
4.  **Quantity**: 個数を入力します。
5.  **Unstackable**: 段積み不可の場合はチェックを入れます。
6.  **`+`** ボタンを押してリストに追加します。

### 方法 B: デモデータのロード (Demo)
1.  リストの下にある "**Load Demo**" ボタンをクリックします。

### 方法 C: AIによる自動抽出 (AI Extraction) ✨
面倒なデータ入力をAI（AI Advisor）に任せることができます。

1.  **画像の読み込み**: クリップアイコン📎をクリック、または画像を直接アプリ画面にドラッグ＆ドロップします。
2.  **テキスト入力**: メールの本文などをコピーしてメッセージ欄に貼り付けます。
3.  **適用**: AIが解析に成功すると、画面に緑色の "**Import Identified Cargo?**" パネルが表示されます。`Apply` を押すとリストに反映されます。

### 方法 D: 外部AIの活用（System Prompt のコピー & 貼付） 🛠️
ブラウザ上の ChatGPT や Claude 等の強力な外部モデルを使用してデータを生成し、本アプリに持ち込むことができます。

1.  **プロンプトのコピー**: AI Advisor ヘッダーのコピーボタン（📋マーク）をクリックします。
2.  **外部AIに指示**: ChatGPT等にプロンプトを貼り付け、その後にパッキングリスト等の指示を与えます。
3.  **JSONのインポート**: 生成されたコード（JSON形式）をコピーします。
4.  **貼付（Manual Import）**: AI Advisor ヘッダーのファイルアイコン（📄マーク）をクリックし、ポップアップに JSON を貼り付けて `Parse & Update` を押します。

---

## 3. 最適化計算 (Optimization)

本アプリでは、貨物リストが更新されると **自動的に計算が開始されます**。特別な計算ボタンを押す必要はありません。

1.  画面左中央の "**Optimization Plan**" セクションで手法を選択します。
    *   **Smart Optimized Mix**: 荷量に応じて、最適なコンテナの種類を自動的に組み合わせて提案します。
    *   **Custom Plan (New)**: 提案されたコンテナ数量（"Uniform Containers" リストの数字）を直接書き換えることができます。
        *   **容量不足警告**: 数量を減らして貨物が入り切らなくなった場合、リストの下に赤色の警告 "**Insufficient Capacity**" が表示され、積み残された貨物がリストアップされます。
2.  空間インデックス（Spatial Grid）技術により、数千個の貨物でも数分で計算が完了します。

---

## 4. 3D手動モード・結果確認 (Manual & Visualization)

Forklift Desirer は、物理エンジンに基づいた強力な手動調整モードを提供します。

### 手動操作 (Manual Interaction)
*   **ドラッグ＆ドロップ (Drag & Drop)**: 貨物を左クリックしてドラッグすると、コンテナ内で移動できます。
    *   **物理スタッキング (Physics Stacking)**: 他の貨物の上にドラッグすると、自動的に「よじ登って」上に積み重なります。システムはリアルタイムで衝突を検知し、めり込みを防ぎます。
    *   **グローバルスナップ (Global Snapping)**: 貨物はコンテナの壁や隣接する他の貨物の端に自動的に吸着（コンテナまたぎのスナップも対応）し、整列を助けます。
*   **ダブルクリック (Double Click)**:
    *   **90度回転**: 貨物をダブルクリックすると、90度回転します。
*   **選択操作 (Selection)**:
    *   **単一選択**: 貨物をクリックして選択します。
    *   **複数選択**: `Ctrl` (Windows) または `Cmd` (Mac) を押しながら貨物をクリックして、選択の追加/解除を行います。
    *   **矩形選択 (Box Select)**: `Shift` を押しながらマウスをドラッグ（貨物の上から開始しても可）すると、選択範囲を描画して一括選択できます。
    *   **選択解除**: 何もない場所をクリックします。
*   **カメラ操作 (Camera Controls)**:
    *   **回転**: マウスの中ボタン（ホイール）をドラッグ / 何も選択していない状態で左ドラッグ。
    *   **移動（パン）**: マウスの右ボタンをドラッグ。
    *   **ズーム**: マウスホイールをスクロール。
*   **情報ツールチップ (Info Tooltip)**: コンテナの上にマウスを **3秒間** ホバーすると、詳細な統計情報（体積、重量、貨物リスト）が表示されます。
    *   **情報のコピー**: ツールチップが表示されている間に `Ctrl+C` を押すと、完全なマニフェストをクリップボードにコピーできます。
    *   **元に戻す (Undo)**: `Ctrl+Z` を押すと、直前の移動操作を取り消すことができます。

### 表示コントロール
*   **🔄 (Reset/Restart)**: 積み付けアニメーションを最初から再再生します。
*   **⏩ (Fast Forward)**: アニメーションをスキップして、最終的な積載状態を即座に表示します。
*   **All / ページ番号**: 複数のコンテナがある場合、**「All」**をクリックすると全てのコンテナを並べて表示できます。矢印ボタンでページを切り替えて1つずつ確認することも可能です。

---

## 5. AIの設定 (AI Config)

右上の **[AI Config]** ボタンから設定メニューを開けます。

*   **Ollama (Local)**: 自身のPCで動作するAI。プライバシー面で最も安全です。
*   **OpenAI Compatible**: OpenAIのAPIや、LM Studio等のローカルサーバーを使用する場合に設定します。

---

## よくある質問 (FAQ)

**Q. 計算が始まりません。**
A. 貨物のサイズがコンテナの最大内寸（長さ12m弱など）を超えていないか、数量が0になっていないか確認してください。

**Q. "Unstackable" の効果は？**
A. 「この貨物の上に他の物を置かない」制約が加わります。背の高い機械や、壊れやすい貨物に使用してください。

**Q. 画像認識がうまくいきません。**
A. 画像内のテキストが鮮明であることを確認してください。また、表形式のデータであれば、Excelからテキストとしてコピー＆ペーストする方が精度が高い場合があります。前述の「方法 D」も活用してください。

---

© 2024 Forklift Desirer Optimization Team.
